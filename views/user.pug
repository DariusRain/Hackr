<<<<<<< HEAD
doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport', content='width=device-width, initial-scale=1.0')
  meta(http-equiv='X-UA-Compatible', content='ie=edge')
  title &#x1F468;&zwj;&#x1F4BB;Hackr
  style.
    * { "font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;"}
    a { padding: 5px; font-size: 18px; text-decoration: none;}
    button {font-size: 20px;}

body(style="margin: 0; background-color: #dee2e2; overflow-x:hidden;" align="center")
  header(style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;")
    #heading-div
      h1(style=" margin: 0; background-color: #7cff85; text-align: center; padding: 12px; box-shadow: 0px 2px 12px;") &#x1F468;&zwj;&#x1F4BB;Hackr
      nav(style="display: flex; flex-direction: row; ")
        button(id="show_profile") Profile
        button(id="show_headlines") Headlines
        button(id="show_wall") Live Feed 
        button(id="log_out") Logout
    - const avatar = data._doc.data.avatar_url
    - const bio = data._doc.data.bio
    - const reposUrl = data._doc.data.repos_url;
    - const username = data._doc.data.login
    - const repos = data._doc.data.public_repos;
    - const linkTo = `https://www.github.com/${username}`;  
    p( id="url" style="display: none") #{reposUrl}
    p(id="data" style="display:none") #{JSON.stringify(data)}
    p #{repoz}

div(style="display: flex; flexwrap: nowrap; flex-direction: column; justify-content: spaced; width: 100%; height:100%; float:left;" )
    div(id="headline" style="display: flex; flexwrap: nowrap; flex-direction: column; width: 100%; height:100%;" )
      div(style="background-color: black; width: 100%; border-bottom-right-radius: 12px; border-bottom-left-radius: 12px; opacity: 0.7;" align="center")
        h1(style="color: white;  ") Welecome to Hackr v0.0.1
        p(style="color:white;") Connect linkedin or github and start a conversation with other fellow hackrs
        br
        strong(style="color: orangered;") Currently working on settingup 0auth!
        p(style="color:white;") Working on setting up 0auth for git & linkedin
        
    div( id="profile_div", style="display: flex; flexwrap: nowrap; flex-direction: column;  width: 100%; overflow-y: auto; border-style: solid; border-color: #dee2e2; border-top-color: black; border-bottom-color: black" align="center")
      div
        img(src="https://s3.us-east-2.amazonaws.com/upload-icon/uploads/icons/png/10412341841540553610-256.png" width="65px" style="padding-left: 12px; margin-top: 20px;")      
        hr(style="width: 99%")
        br
        img(src="" + avatar width="150px" style="border-radius: 12px; border-style: solid;")
        h1 #{username}       
      div(style="padding: 10px;")

        h2 Bio
    
        p(style="width: 250px; font-style: bold-italic; font-size: 24px;") #{bio}
      div
          div(id="all_repos" style="background-color: #7cff85; text-align: center;")
            h2 Repositories Found: #{repos}
div(id="feed", style="width: 100%; height:100%;" align="center")
  textarea(id="post_text", type="textarea", style="background-color: black; color:white; opacity: 0.7; font-weight: bold; border-bottom-right-radius: 12px; width: 50%; border-bottom-left-radius: 12px;font-size:30px; text-align:center; margin: 0 auto;")
  br
  button(id="invoke_post", style="background-color: #7cff85; border-radius:4px; width: 25%; margin: 0 auto; font-size: 16px") Post
   
script.
          let reposUrl = document.getElementById("url").innerText
          let show_profile = document.getElementById("show_profile")
          let profile = document.getElementById("profile_div")
          let show_headline = document.getElementById("show_headlines");
          let headline = document.getElementById("headline");
          let feed_div = document.getElementById("feed");
          let invoke_post = document.getElementById("invoke_post");
          let post_text = document.getElementById("post_text").value
          const data = JSON.parse(document.getElementById("data").innerText);
          show_headline.addEventListener('click', showHeadline);
          show_profile.addEventListener('click', showProfile);

          invoke_post.addEventListener('click', createPost);
          console.log(profile)
          function showProfile() {
            if(profile.style.display === 'none'){
              
            return profile.style.display = 'block'
              
            }else {
              return profile_div.style.display = 'none'
            }
           
          }
           function showHeadline() {
            if(headline.style.display === 'none'){
              
            return headline.style.display = 'block'
              
            }else {
              return headline.style.display = 'none'
            }
           
          }

          let all_repos_div = document.getElementById("all_repos");
          repos = async () =>{
            await fetch(reposUrl)
              .then(result => result.json())
              .then(result => { 
                val = result
                })
              .catch(err => console.log(0, err))
          }
          repos()
          let count = 0;
          setTimeout(() => {
          console.log(val)
            val.forEach(element => {
              let anchor = document.createElement("a");
              anchor.style.fontSize = "30px";
              anchor.style.fontWeight = "bold";
              anchor.style.color = "black"
              anchor.style.textDecoration = "none";
              let breakz = document.createElement("p")
              breakz.style.padding = "50px"
              anchor.innerText = `(${++count}) ${element.name}`;
              anchor.setAttribute("href", element.html_url)
              all_repos_div.appendChild(anchor)
              all_repos_div.appendChild(breakz)
              all_repos_div.appendChild(breakz)
              
            })
          }, 1000)
          console.log(1, data)
          
          console.log(`${window.location}/${data.username}/live`)
           feed = async () =>{
            await fetch(`${window.location}/${data.username}/live`)
              .then(result => result.json())
              .then(result => { 
                feedObject = result
                return result
                })
              .catch(err => console.log(0, err))
          }
          feed()
          setTimeout(() => {
            console.log(feedObject.feed)

           feedObject.feed.reverse().forEach(element => {
              let div = document.createElement("div");
              let profile_name_div = document.createElement("div")
              let message_div = document.createElement("div")
              let thumbs_div = document.createElement("div")
              let h3 = document.createElement("pre");
              let img = document.createElement("img");
              let kbd = document.createElement("pre");
              let upVote = document.createElement("a")
              let downVote = document.createElement("a")
              let breakSt = document.createElement("br")
              let lineBreak = document.createElement("hr")
              message_div.style.height = "100%"
              thumbs_div.style.height = "100%"
              thumbs_div.style.float = "left"
              profile_name_div.style.height = "100%"
              div.style.overflow = "auto"
              div.style.margin = "13px";
              img.style.float = "left";
              h3.style.float = "left";
              img.style.width = "70px";
              img.style.borderRadius = "12px"
              div.style.height = "90px"
              lineBreak.style.color = "white"
              h3.style.fontSize = "25px"
              div.style.height = "100%"
              kbd.style.fontSize = "18px"
              downVote.style.color = "white"
              upVote.style.color = "white"
              downVote.style.fontSize = "40px"
              upVote.style.fontSize = "40px"
              div.style.paddingColor = "white;"
              div.style.display = "flex";
              div.style.flexDirection = "column"
              div.style.flexWrap = "wrap"
              div.style.padding = "12px"
              div.style.color = "white";
              div.style.width = "50%"
              div.style.backgroundColor = "black";
              div.style.opacity = "0.7";
              div.style.borderRadius = "12px";
              kbd.style.color = "black !important"
              upVote.innerText = "0 üëç";
              downVote.innerText = "üëé 0";
              upVote.setAttribute("href", `http://localhost:5000/user/${element._id}/upvote`)
              downVote.setAttribute("href", `http://localhost:5000/user/${element._id}/downvote`)
              img.setAttribute("src", element.avatar);
              h3.innerText = `   ${element.username}`;
              kbd.innerText = element.post;
              profile_name_div.appendChild(img)
              profile_name_div.appendChild(breakSt)
              message_div.appendChild(kbd)
              message_div.appendChild(breakSt)              
              profile_name_div.appendChild(h3)
              thumbs_div.appendChild(lineBreak)
              thumbs_div.appendChild(upVote)
              thumbs_div.appendChild(downVote)
              div.appendChild(profile_name_div);
              div.appendChild(message_div);
              div.appendChild(thumbs_div);              
              feed_div.appendChild(div)
              feed_div.appendChild(breakSt)
            })
          }, 2000)

      async function createPost() {
        event.preventDefault();
        await fetch("http://localhost:5000/user/post-it", 
        {
        method: "POST",
        headers: {
            Accept: "application/json",
            "content-type": "application/json"
        },
        body: JSON.stringify({
          avatar: data.data.avatar_url.toString(),
          username: data.username.toString(),
          uid: data._id.toString(),
          post: post_text.toString()
          })
        })
        .then(result => {
        return result;
        })
        .catch(err => {
        return err;
        })
      }
      
=======
extends index.pug
block head
  style. 
    .container-row {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;display: flex; flex-direction:column; padding:20px; width:88%; flex-wrap: wrap; margin:0 auto; padding-top: 20px; border-radius: 12px;}
    .container-row-buttons {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction:row; flex-wrap: wrap;  margin: 0 auto;}    
    .container-column {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column}
    .container-item-1 {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #98B4D4; text-align: center; width: 100%;}
    .buttons {padding: 8px; background-color:#98B4D4; border-color: #98B4D4 ; border-style:solid; border-top-color: black; border-bottom-right-radius:15px; margin-right: 5px; border-bottom-left-radius:15px; box-shadow: 0px 2px 6px;  font-size: 20px; font-weight: bold;}
    .buttons-post {padding: 8px; background-color:#7cff85; border-color: #98B4D4 ; border-style:solid; border-top-color: black; border-bottom-right-radius:15px; margin-right: 5px; border-bottom-left-radius:15px; box-shadow: 0px 2px 6px;  font-size: 20px; font-weight: bold;}
    #profile_button:hover {color: #7cff85;}
    #headline_button:hover {color: #7cff85;}
    #submit_post:hover {background-color: white; padding: 12px;}
    #headline {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color:black; opacity: 0.7; color: white; font-size: 40px; width:88%; margin: 0 auto; text-align: center;}
    #list_repos {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column; flex-wrap: wrap;}
    #post_form {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0 auto; padding: 100px; width: 60%; display: flex; flex-direction: column; }
    #post {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #98B4D4;}
    #feed_div {display: flex; flex-direction: column;}


block content
  div(class="container-row-buttons")
    button(class="buttons" id="profile_button") Profile
    button(class="buttons") Feed
    button(class="buttons" id="headline_button") Headlines
    button(class="buttons") Logout
  div(id="headline")
    pre(style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;"). 
      Welcome to hackr (Development version v1.0.3) 
      
      Now configuring Oauth to appplication (Almost at stable release)
  div(class="container-row" id="profile_box" width="100%")
    div(class="container-item-1")
      div(style="background-color:#7cff85; width: 100%;")
        img(alt="github icon" src="https://cdn.iconscout.com/icon/free/png-256/github-1693585-1442626.png" style="margin-right: -1px; text-align: none !important;" width="70px")    
      a(style="font-size: 40px;", id="uNameAnchor")           
        img(alt="Photo of user", id="avatar", width="300px", style="border-style:solid; border-color:black; border-radius: 12px; margin:20px;") 
      h1 #{user.user}      
      br
      h3(id="bio_text", style="font-size: 25px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;")
      hr
      h3(id="num_repos")
      hr
      div(id="list_repos")
  br
  div(id="post_form", align="center")
    div(style="background-color:#7cff85; width: 100%;")
      h3(style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 20px;") Post to board  
    div(id="post")
      textarea(id="post_text",name="text", type="text", style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: black; opacity: 0.7; color: white; margin:25px; text-align:center; font-size: 33px; width:66%; font-weight: bold;")
      br
      button(id="submit_post", class="buttons-post") Post
      p
  div(id="feed_div") 

    script. 
      document.getElementById("profile_button").addEventListener('click', showProfile)
      document.getElementById("headline_button").addEventListener('click', showHeadline)
      document.getElementById("submit_post").addEventListener('click', createPost)


      const username = "#{user.user}"
      document.getElementById("uNameAnchor").setAttribute("href", `https://github.com/${username}`)
      const data = "#{user.profile}"




      let git_data,
        errors = [],
        repo_data, 
        bioText, 
        avatarUrl, 
        reposUrl, 
        mainUrl,
        feed,
        numRepos;


      function showHeadline(){
      let style = document.getElementById("headline").style
        if (style.display === 'block') {
          style.display = 'none'
        }else {
          style.display = 'block'
        }
      }

      function showProfile() {
        let style = document.getElementById("profile_box").style
          if (style.display === 'flex') {
            style.display = 'none'
          }else {
            style.display = 'flex'
          }
      }


      function createPost() {
        const post_text = document.getElementById('post_text').value.trim();
        const post_val = document.getElementById('post_text').value
          sent_post = (async () => {
            await fetch(
              window.location.href,
              {
                method: 'POST',
                headers: {
                  Accept: 'application/json',
                  'content-type': 'application/json'
                },
                body: JSON.stringify({
                  user: username,
                  avatar: avatarUrl,
                  post: post_text
                })
              }).then(response => {
                return response.json()
              })
              .then(response => {
                alert(response.message)
                post_value = ''
                window.location.reload()
              })
              .catch(err => {
                alert(err.message)
              })

              }
              )()
        return sent_post
      }



      get_data = (async () => {
      const fetch_data = await fetch(`https://api.github.com/users/${username}`)
        .then(data => { return data.json() })
        .then(data => { git_data = data })
        .catch(err => { return errors.push("func 'get_data()' -> CATCHED ERROR") })
        return fetch_data
      })() 


      get_feed = (async () => {
      let { href } = window.location
      const run_feed = await fetch(href.replace(`/profile/${username}`, '/feed')).then(response => {return response.json()})
        .then(response => {
          feed = response
        })
        .catch(err => {
          return err.message;
        })
        return run_feed;
      })()


      setTimeout(() => {
      
      const { bio, avatar_url, public_repos, url, repos_url } = git_data
        bioText = bio;
        reposUrl = repos_url;
        avatarUrl = avatar_url;
        reposUrl = repos_url;
        mainUrl = url;
        numRepos = public_repos;
     
      }, 1000)




      get_repos = (async () => {
        //- console.log(reposUrl)
        const fetch_data = await fetch(reposUrl)
        .then(data => { return data.json() })
        .then(data => { repo_data = data })
        .catch(err => { return errors.push("func 'get_repos()' -> CATCHED ERROR") })
        return fetch_data
        })



      //-This sets the data for num of repos and the bio
      setTimeout(() => {
        get_repos()
       
        //- console.log(bioText, avatarUrl, reposUrl, mainUrl)
          document.getElementById("avatar").setAttribute('src', avatarUrl)
          document.getElementById("num_repos").innerText = `Repositories: ${numRepos}`
          document.getElementById("bio_text").innerText = bioText || null       
      }, 1200)





        //-This is what lists the repos.
      setTimeout(() => {

        let count = 0; 
        let none = ['none']       
        repo_data.forEach(element => {
        let parent = document.getElementById("list_repos")          
        let div = document.createElement("div");
        let number = document.createElement("h4");
        let anchor = document.createElement("a");
        let breakSt = document.createElement("br")
        let horzBrkSt = document.createElement("hr")

        div.style = 'margin: 0 auto; border-radius:10px; opacity:0.6; margin-bottom: 20px; text-decoration: none; width:50%; border-style: solid; padding: 12px; background-color: black;' 

        number.innerText = ++count;
        number.style = 'font-size: 20px; color: #7cff85;' 

        anchor.setAttribute("href", element.html_url);
        anchor.innerText = element.name;          
        anchor.style = 'font-size: 25px; color: white; text-decoration: none;'

        horzBrkSt.style = 'color:#7cff85;'

        div.appendChild(number)
        div.appendChild(anchor)


        parent.appendChild(div)
        parent.appendChild(breakSt)
        })

      }, 1500)

        //-T


        //-This loads all the posts on the page.
      setTimeout(() => {
        let parent = document.getElementById("feed_div")
        feed.reverse().forEach(object => {
          let div = document.createElement("div"),
            img = document.createElement("img"),
            a = document.createElement("a"),
            pre = document.createElement("pre"),
            breakSt = document.createElement("br"),
            horzBreak = document.createElement("hr"),
            thumbUp = document.createElement("a"),            
            thumbDown = document.createElement("a");

            div.style = 'background-color: #98B4D4; width: 66%; margin: 0 auto; margin-bottom: 12px; text-align: center; padding: 20px;';
            pre.style = 'background-color: black; text-align: center; opacity: 0.7; width: 50%; border-radius:12px; color: white; padding: 20px; margin: 0 auto; font-size: 20px;';
            thumbUp.style = 'font-size: 40px; text-decoration: none;'
            thumbDown.style = 'font-size: 40px; text-decoration: none;'
            horzBreak.style = 'background-color: #7cff85; margin-top: 20px; height: 10px; border-radius: 12px;'
            img.setAttribute('src', object.avatar);
            img.style = 'border-radius: 12px; border-color: black; width:100px; border-style: solid; margin-bottom: 20px;';
            a.setAttribute('href', `https://www.github.com/${object.username}`);
            thumbDown.setAttribute('href', `http://localhost:5000/user/thumbup/${username}/${object._id}`)
            thumbUp.setAttribute('href', `http://localhost:5000/user/thumbdown/${username}/${object._id}`)
            a.appendChild(img);
            thumbUp.innerText = 'üëç';
            thumbDown.innerText = 'üëé';
            pre.innerText = object.post;
            div.appendChild(a);
            div.appendChild(horzBreak);
            div.appendChild(pre);
            div.appendChild(horzBreak);
            div.appendChild(thumbUp);
            div.appendChild(thumbDown)
            parent.appendChild(div)
        })
      }, 1800)

      //- alert(`Welecome ${data}`)
      //-alert(git_data)
>>>>>>> Oauthv1.0.1
